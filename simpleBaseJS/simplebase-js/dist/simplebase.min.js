(function (global, factory) {
    if (typeof define === 'function' && define.amd) {
        define([], factory);
    } else if (typeof exports === 'object') {
        module.exports = factory();
    } else {
        global.SimpleBase = factory();
    }
}(this, function () {
    'use strict';

    function apiCall(script, data) {
        const BASE_URL = 'http://localhost';
        return fetch(`${BASE_URL}/${script}?token=${getToken()}`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        }).then(response => response.json());
    }

    function createToken() {
        return Math.random().toString(36).substr(2, 9);
    }

    function createTable(tablename, columns) {
        const data = {
            query: 'createTable',
            tablename: tablename,
            columns: columns
        };
        return apiCall('createDB.php', data);
    }

    function writeData(tablename, newdata) {
        const data = {
            query: 'newRow',
            tablename: tablename,
            newdata: newdata
        };
        return apiCall('writeData.php', data);
    }

    function getData(tablename) {
        const data = {
            query: 'getall',
            tablename: tablename
        };
        return apiCall('getData.php', data);
    }

    function updateData(tablename, where, newdata) {
        const data = {
            query: 'updateRow',
            tablename: tablename,
            where: where,
            newdata: newdata
        };
        return apiCall('updateData.php', data);
    }

    function saveToken(token) {
        localStorage.setItem('simplebase_token', token);
    }

    function getToken() {
        return localStorage.getItem('simplebase_token') || '';
    }

    function displayShareUI() {
        const token = getToken();
        const shareUrl = `${window.location.origin}?token=${token}`;
        // Logic to display the share UI with the shareUrl
    }

    return {
        createToken: createToken,
        createTable: createTable,
        writeData: writeData,
        getData: getData,
        updateData: updateData,
        saveToken: saveToken,
        getToken: getToken,
        displayShareUI: displayShareUI
    };
}));